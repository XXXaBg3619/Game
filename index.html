<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>區塊鏈模擬的投票系統</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; }
    .container { max-width: 400px; margin: auto; padding: 20px; }
    button { padding: 10px 20px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>線上投票 (模擬區塊鏈和 ZKP)</h1>
    <form id="voteForm">
      <p>您最喜歡的飲料是什麼？</p>
      <input type="radio" id="coffee" name="vote" value="coffee">
      <label for="coffee">咖啡</label><br>
      <input type="radio" id="tea" name="vote" value="tea">
      <label for="tea">茶</label><br>
      <input type="radio" id="juice" name="vote" value="juice">
      <label for="juice">果汁</label><br>
      <br>
      <button type="button" onclick="submitVote()">提交投票</button>
    </form>
    <div id="results">
      <h2>投票結果 (模擬)</h2>
      <p>咖啡: <span id="coffeeCount">0</span></p>
      <p>茶: <span id="teaCount">0</span></p>
      <p>果汁: <span id="juiceCount">0</span></p>
    </div>
  </div>

  <script>
    // 初始化模擬區塊鏈
    let blockchain = [];
    let voteCounts = { coffee: 0, tea: 0, juice: 0 };

    // 零知識證明的模擬驗證（在這裡簡化為隨機數校驗）
    function zeroKnowledgeProof() {
      return Math.random() > 0.5;  // 模擬 50% 的驗證成功率
    }

    // 更新投票結果顯示
    function updateResults() {
      document.getElementById("coffeeCount").textContent = voteCounts.coffee;
      document.getElementById("teaCount").textContent = voteCounts.tea;
      document.getElementById("juiceCount").textContent = voteCounts.juice;
    }

    // 提交投票
    function submitVote() {
      const selectedVote = document.querySelector('input[name="vote"]:checked');
      if (!selectedVote) {
        alert("請選擇一個選項！");
        return;
      }

      // 模擬 ZKP 驗證
      const isVerified = zeroKnowledgeProof();
      if (!isVerified) {
        alert("投票驗證失敗，請重試！");
        return;
      }

      const voteOption = selectedVote.value;
      voteCounts[voteOption] += 1;

      // 模擬將投票紀錄加入區塊鏈
      const block = {
        id: blockchain.length + 1,
        vote: voteOption,
        timestamp: new Date().toISOString()
      };
      blockchain.push(block);

      updateResults();
      alert("投票成功，已模擬記錄至區塊鏈！");
      console.log("模擬區塊鏈紀錄：", blockchain);
    }

    // 初始化頁面時更新顯示
    window.onload = updateResults;
  </script>
</body>
</html>